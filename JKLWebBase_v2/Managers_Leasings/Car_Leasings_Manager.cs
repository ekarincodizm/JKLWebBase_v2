using System;
using System.Collections.Generic;
using MySql.Data.MySqlClient;
using JKLWebBase_v2.Global_Class;
using JKLWebBase_v2.Class_Leasings;
using System.Data;

namespace JKLWebBase_v2.Managers_Leasings
{
    public class Car_Leasings_Manager
    {
        private string error;

        public string generateLeasingID()
        {
            MySqlConnection con = MySQLConnection.connectionMySQL();
            try
            {
                con.Open();
                string sql = "SELECT * FROM v_getleasingcarid ";
                MySqlCommand cmd = new MySqlCommand(sql, con);
                MySqlDataReader reader = cmd.ExecuteReader();
                string id = "";
                if (reader.Read())
                {
                    id = reader[0].ToString();
                }

                return id;
            }
            catch (MySqlException ex)
            {
                error = "MysqlException ==> Managers_Leasings --> Car_Leasings_Manager --> generateLeasingID() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return null;
            }
            catch (Exception ex)
            {
                error = "Exception ==> Managers_Leasings --> Car_Leasings_Manager --> generateLeasingID() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return null;
            }
            finally
            {
                con.Close();
                con.Dispose();
            }
        }

        public Car_Leasings getCarLeasingById(string Leasing_id)
        {
            MySqlConnection con = MySQLConnection.connectionMySQL();
            try
            {
                /* 
                 * :: StoredProcedure :: [ g_car_leasings_by_id ] :: 
                 * g_car_leasings_by_id (in i_Leasing_id varchar(50))
                 * 
                 */

                con.Open();
                MySqlCommand cmd = new MySqlCommand("g_car_leasings_by_id", con);
                cmd.CommandType = CommandType.StoredProcedure;
                cmd.Parameters.AddWithValue("@i_Leasing_id", Leasing_id);

                MySqlDataReader reader = cmd.ExecuteReader();

                Car_Leasings cls = new Car_Leasings();

                if (reader.Read())
                {
                    int defaultNum = 0;
                    string defaultString = "";

                    cls.Leasing_id = reader.IsDBNull(0) ? defaultString : reader.GetString(0);
                    cls.Deps_no = reader.IsDBNull(1) ? defaultString : reader.GetString(1);
                    cls.Leasing_no = reader.IsDBNull(2) ? defaultString : reader.GetString(2);
                    cls.Leasing_code_id = reader.IsDBNull(3) ? defaultNum : reader.GetInt32(3);
                    cls.Leasing_date = reader.IsDBNull(4) ? defaultString : reader.GetString(4);
                    cls.Branch_id = reader.IsDBNull(5) ? defaultNum : reader.GetInt32(5);
                    cls.Zone_id = reader.IsDBNull(6) ? defaultNum : reader.GetInt32(6);
                    cls.Court_id = reader.IsDBNull(7) ? defaultNum : reader.GetInt32(7);
                    cls.PeReT = reader.IsDBNull(8) ? defaultString : reader.GetString(8);
                    cls.TotalPaymentTime = reader.IsDBNull(9) ? defaultNum : reader.GetInt32(9);
                    cls.Total_require = reader.IsDBNull(10) ? defaultNum : reader.GetDouble(10);
                    cls.Vat_rate = reader.IsDBNull(11) ? defaultNum : reader.GetDouble(11);
                    cls.Interest_rate = reader.IsDBNull(12) ? defaultNum : reader.GetDouble(12);
                    cls.Total_period = reader.IsDBNull(13) ? defaultNum : reader.GetInt32(13);
                    cls.Total_sum = reader.IsDBNull(14) ? defaultNum : reader.GetDouble(14);
                    cls.Total_Interest = reader.IsDBNull(15) ? defaultNum : reader.GetDouble(15);
                    cls.Total_Tax = reader.IsDBNull(16) ? defaultNum : reader.GetDouble(16);
                    cls.Total_leasing = reader.IsDBNull(17) ? defaultNum : reader.GetDouble(17);
                    cls.Total_Net_leasing = reader.IsDBNull(18) ? defaultNum : reader.GetDouble(18);
                    cls.Period_cal = reader.IsDBNull(19) ? defaultNum : reader.GetDouble(19);
                    cls.Period_interst = reader.IsDBNull(20) ? defaultNum : reader.GetDouble(20);
                    cls.Period_tax = reader.IsDBNull(21) ? defaultNum : reader.GetDouble(21);
                    cls.Period_pure = reader.IsDBNull(22) ? defaultNum : reader.GetDouble(22);
                    cls.Period_payment = reader.IsDBNull(23) ? defaultNum : reader.GetDouble(23);
                    cls.Period_require = reader.IsDBNull(24) ? defaultNum : reader.GetDouble(24);
                    cls.Total_period_length = reader.IsDBNull(25) ? defaultString : reader.GetString(25);
                    cls.Total_period_lose = reader.IsDBNull(26) ? defaultNum : reader.GetInt32(26);
                    cls.Total_period_left = reader.IsDBNull(27) ? defaultNum : reader.GetInt32(27);
                    cls.Total_payment_left = reader.IsDBNull(28) ? defaultNum : reader.GetDouble(28);
                    cls.Payment_schedule = reader.IsDBNull(29) ? defaultNum : reader.GetInt32(29);
                    cls.First_payment_date = reader.IsDBNull(30) ? defaultString : reader.GetString(30);
                    cls.Car_register_date = reader.IsDBNull(31) ? defaultString : reader.GetString(31);
                    cls.Car_license_plate = reader.IsDBNull(32) ? defaultString : reader.GetString(32);
                    cls.Car_plate_province = reader.IsDBNull(33) ? defaultNum : reader.GetInt32(33);
                    cls.Car_type = reader.IsDBNull(34) ? defaultString : reader.GetString(34);
                    cls.Car_feature = reader.IsDBNull(35) ? defaultString : reader.GetString(35);
                    cls.Car_brand = reader.IsDBNull(36) ? defaultNum : reader.GetInt32(36);
                    cls.Car_model = reader.IsDBNull(37) ? defaultString : reader.GetString(37);
                    cls.Car_year = reader.IsDBNull(38) ? defaultString : reader.GetString(38);
                    cls.Car_color = reader.IsDBNull(39) ? defaultString : reader.GetString(39);
                    cls.Car_engine_no = reader.IsDBNull(40) ? defaultString : reader.GetString(40);
                    cls.Car_engine_no_at = reader.IsDBNull(41) ? defaultString : reader.GetString(41);
                    cls.Car_engine_brand = reader.IsDBNull(42) ? defaultString : reader.GetString(42);
                    cls.Car_chassis_no = reader.IsDBNull(43) ? defaultString : reader.GetString(43);
                    cls.Car_chassis_no_at = reader.IsDBNull(44) ? defaultString : reader.GetString(44);
                    cls.Car_fual_type = reader.IsDBNull(45) ? defaultString : reader.GetString(45);
                    cls.Car_gas_No = reader.IsDBNull(46) ? defaultString : reader.GetString(46);
                    cls.Car_used_id = reader.IsDBNull(47) ? defaultNum : reader.GetInt32(47);
                    cls.Car_distance = reader.IsDBNull(48) ? defaultNum : reader.GetInt32(48);
                    cls.Car_next_register_date = reader.IsDBNull(49) ? defaultString : reader.GetString(49);
                    cls.Car_tax_value = reader.IsDBNull(50) ? defaultNum : reader.GetDouble(50);
                    cls.Car_credits = reader.IsDBNull(51) ? defaultString : reader.GetString(51);
                    cls.Car_agent = reader.IsDBNull(52) ? defaultString : reader.GetString(52);
                    cls.Car_old_owner = reader.IsDBNull(53) ? defaultString : reader.GetString(53);
                    cls.Car_old_owner_idcard = reader.IsDBNull(54) ? defaultString : reader.GetString(54);
                    cls.Car_old_owner_b_date = reader.IsDBNull(55) ? defaultString : reader.GetString(55);
                    cls.Car_old_owner_address_no = reader.IsDBNull(56) ? defaultString : reader.GetString(56);
                    cls.Car_old_owner_vilage = reader.IsDBNull(57) ? defaultString : reader.GetString(57);
                    cls.Car_old_owner_vilage_no = reader.IsDBNull(58) ? defaultString : reader.GetString(58);
                    cls.Car_old_owner_alley = reader.IsDBNull(59) ? defaultString : reader.GetString(59);
                    cls.Car_old_owner_road = reader.IsDBNull(60) ? defaultString : reader.GetString(60);
                    cls.Car_old_owner_subdistrict = reader.IsDBNull(61) ? defaultString : reader.GetString(61);
                    cls.Car_old_owner_district = reader.IsDBNull(62) ? defaultString : reader.GetString(62);
                    cls.Car_old_owner_province = reader.IsDBNull(63) ? defaultNum : reader.GetInt32(63);
                    cls.Car_old_owner_contry = reader.IsDBNull(64) ? defaultString : reader.GetString(64);
                    cls.Car_old_owner_zipcode = reader.IsDBNull(65) ? defaultString : reader.GetString(65);
                    cls.Cust_id = reader.IsDBNull(66) ? defaultString : reader.GetString(66);
                    cls.Tent_car_id = reader.IsDBNull(67) ? defaultNum : reader.GetInt32(67);
                    cls.Cheque_receiver = reader.IsDBNull(68) ? defaultString : reader.GetString(68);
                    cls.Cheque_bank = reader.IsDBNull(69) ? defaultString : reader.GetString(69);
                    cls.Cheque_bank_branch = reader.IsDBNull(70) ? defaultString : reader.GetString(70);
                    cls.Cheque_number = reader.IsDBNull(71) ? defaultString : reader.GetString(71);
                    cls.Cheque_sum = reader.IsDBNull(72) ? defaultNum : reader.GetDouble(72);
                    cls.Cheque_receive_date = reader.IsDBNull(73) ? defaultString : reader.GetString(73);
                    cls.Contract_status = reader.IsDBNull(74) ? defaultString : reader.GetString(74);
                    cls.Leasings_save_date = reader.IsDBNull(75) ? defaultString : reader.GetString(75);

                }

                return cls;
            }
            catch (MySqlException ex)
            {
                error = "MysqlException ==> Managers_Leasings --> Car_Leasings_Manager --> getCarLeasing() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return null;
            }
            catch (Exception ex)
            {
                error = "Exception ==> Managers_Leasings --> Car_Leasings_Manager --> getCarLeasing() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return null;
            }
            finally
            {
                con.Close();
            }
        }

        public List<Car_Leasings_Payment> getPaymentScheduleById(string Leasing_id)
        {
            MySqlConnection con = MySQLConnection.connectionMySQL();
            try
            {
                /* 
                 * :: StoredProcedure :: [ g_car_leasings_payment ] :: 
                 * g_car_leasings_payment (in i_Cust_idcard varchar(13))
                 * 
                 */

                con.Open();
                MySqlCommand cmd = new MySqlCommand("g_car_leasings_payment", con);
                cmd.CommandType = CommandType.StoredProcedure;
                cmd.Parameters.AddWithValue("@i_Leasing_id", Leasing_id);

                MySqlDataReader reader = cmd.ExecuteReader();

                List<Car_Leasings_Payment> list_cls_pay = new List<Car_Leasings_Payment>();

                while (reader.Read())
                {
                    Car_Leasings_Payment cls_pay = new Car_Leasings_Payment();
                    int defaultNum = 0;
                    string defaultString = "";

                    cls_pay.Leasing_id = reader.IsDBNull(0) ? defaultString : reader.GetString(0);
                    cls_pay.Period_no = reader.IsDBNull(1) ? defaultNum : reader.GetInt32(1);
                    cls_pay.Count_payment = reader.IsDBNull(2) ? defaultNum : reader.GetInt32(2);
                    cls_pay.Period_schedule = reader.IsDBNull(3) ? defaultString : reader.GetString(3);
                    cls_pay.Period_current = reader.IsDBNull(4) ? defaultNum : reader.GetDouble(4);
                    cls_pay.Period_cash = reader.IsDBNull(5) ? defaultNum : reader.GetDouble(5);
                    cls_pay.Period_value = reader.IsDBNull(6) ? defaultNum : reader.GetDouble(6);
                    cls_pay.Period_principle = reader.IsDBNull(7) ? defaultNum : reader.GetDouble(7);
                    cls_pay.Period_interst = reader.IsDBNull(8) ? defaultNum : reader.GetDouble(8);
                    cls_pay.Period_vat = reader.IsDBNull(9) ? defaultNum : reader.GetDouble(9);
                    cls_pay.Period_fine = reader.IsDBNull(10) ? defaultNum : reader.GetDouble(10);
                    cls_pay.Period_free = reader.IsDBNull(11) ? defaultNum : reader.GetDouble(11);
                    cls_pay.Period_track = reader.IsDBNull(12) ? defaultNum : reader.GetDouble(12);
                    cls_pay.Discount = reader.IsDBNull(13) ? defaultNum : reader.GetDouble(13);
                    cls_pay.Real_payment = reader.IsDBNull(14) ? defaultNum : reader.GetDouble(14);
                    cls_pay.Real_payment_fine = reader.IsDBNull(15) ? defaultNum : reader.GetDouble(15);
                    cls_pay.Real_payment_date = reader.IsDBNull(16) ? defaultString : reader.GetString(16);
                    cls_pay.Total_payment_fine = reader.IsDBNull(17) ? defaultNum : reader.GetDouble(17);
                    cls_pay.Total_payment_left = reader.IsDBNull(18) ? defaultNum : reader.GetDouble(18);
                    cls_pay.Bill_no = reader.IsDBNull(19) ? defaultString : reader.GetString(19);
                    cls_pay.Payment_save_date = reader.IsDBNull(20) ? defaultString : reader.GetString(20);
                    cls_pay.Emp_id = reader.IsDBNull(21) ? defaultString : reader.GetString(21);
                    cls_pay.Branch_id = reader.IsDBNull(22) ? defaultNum : reader.GetInt32(22);

                    list_cls_pay.Add(cls_pay);
                }

                return list_cls_pay;
            }
            catch (MySqlException ex)
            {
                error = "MysqlException ==> Managers_Leasings --> Car_Leasings_Manager --> getPaymentSchedule() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return null;
            }
            catch (Exception ex)
            {
                error = "Exception ==> Managers_Leasings --> Car_Leasings_Manager --> getPaymentSchedule() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return null;
            }
            finally
            {
                con.Close();
            }
        }

        public bool addCarLeasings(Car_Leasings cls)
        {
            MySqlConnection con = MySQLConnection.connectionMySQL();
            try
            {
                /* 
                 * :: StoredProcedure :: [ i_car_leasings ] :: 
                 * `i_car_leasings`(in  i_Leasing_id  varchar(50),              in  i_Deps_no  varchar(50),                     in  i_Leasing_no  varchar(50),                  in  i_Leasing_code_id  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     utf8                  utf8_general_ci       utf8_general_ci   
                 *         		    in  i_Leasing_date  date,                   in  i_Branch_id  int(11),                       in  i_Zone_id  int(11),                         in  i_Court_id  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                 *         		    in  i_PeReT  varchar(255),                  in  i_TotalPaymentTime  int(11),                in  i_Total_require  double(10,2),              in  i_Vat_rate  double(10,2),   in  i_Interest_rate  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                 *         		    in  i_Total_period  int(11),                in  i_Total_sum  double(10,2),                  in  i_Total_Interest  double(10,2),             in  i_Total_Tax  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                 *         		    in  i_Total_leasing  double(10,2),          in  i_Total_Net_leasing  double(10,2),          in  i_Period_cal  double(10,2),                 in  i_Period_interst  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                 *         		    in  i_Period_tax  double(10,2),             in  i_Period_pure  double(10,2),                in  i_Period_payment  double(10,2),             in  i_Period_require  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                 *         		    in  i_Total_period_length  varchar(50),     in  i_Total_period_lose  int(11),               in  i_Total_period_left  int(11),               in  i_Total_payment_left  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                 *         		    in  i_Payment_schedule  int(11),            in  i_First_payment_date  date,                 in  i_Car_register_date  date,                  in  i_Car_license_plate  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                 *         		    in  i_Car_plate_province  int(11),          in  i_Car_type  varchar(255),                   in  i_Car_feature  varchar(255),                in  i_Car_brand  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                 *         		    in  i_Car_model  varchar(255),              in  i_Car_year  varchar(255),                   in  i_Car_color  varchar(255),                  in  i_Car_engine_no  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                 *         		    in  i_Car_engine_no_at  varchar(255),       in  i_Car_engine_brand  varchar(255),           in  i_Car_chassis_no  varchar(255),             in  i_Car_chassis_no_at  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                 *         		    in  i_Car_fual_type  varchar(255),          in  i_Car_gas_No  varchar(255),                 in  i_Car_used_id  int(11),                     in  i_Car_distance  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                 *        		    in  i_Car_next_register_date  date,         in  i_Car_tax_value  double(10,2),              in  i_Car_credits  varchar(255),                in  i_Car_agent  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                 *         		    in  i_Car_old_owner  varchar(255),          in  i_Car_old_owner_idcard  varchar(255),       in  i_Car_old_owner_b_date  date,               in  i_Car_old_owner_address_no  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                 *         		    in  i_Car_old_owner_vilage  varchar(255),   in  i_Car_old_owner_vilage_no  varchar(255),    in  i_Car_old_owner_alley  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                 *         		    in  i_Car_old_owner_road  varchar(255),     in  i_Car_old_owner_subdistrict  varchar(255),  in  i_Car_old_owner_district  varchar(255),     in  i_Car_old_owner_province  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                 *         		    in  i_Car_old_owner_contry  varchar(255),   in  i_Car_old_owner_zipcode  varchar(255),      in  i_Cust_id  varchar(50),                     in  i_Tent_car_id  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                 *         		    in  i_Cheque_receiver  varchar(255),        in  i_Cheque_bank  varchar(255),                in  i_Cheque_bank_branch  varchar(255),         in  i_Cheque_number  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                 *         		    in  i_Cheque_sum  double(10,2),             in  i_Cheque_receive_date  date,                in  i_Contract_status  varchar(5),              in  i_Leasings_save_date  datetime)
                 * 
                 */

                con.Open();
                MySqlCommand cmd = new MySqlCommand("i_car_leasings", con);
                cmd.CommandType = CommandType.StoredProcedure;

                cmd.Parameters.AddWithValue("@i_Leasing_id", cls.Leasing_id);
                cmd.Parameters.AddWithValue("@i_Deps_no", cls.Deps_no);
                cmd.Parameters.AddWithValue("@i_Leasing_no", cls.Leasing_no);
                cmd.Parameters.AddWithValue("@i_Leasing_code_id", cls.Leasing_code_id);
                cmd.Parameters.AddWithValue("@i_Leasing_date", cls.Leasing_date);
                cmd.Parameters.AddWithValue("@i_Branch_id", cls.Branch_id);
                cmd.Parameters.AddWithValue("@i_Zone_id", cls.Zone_id);
                cmd.Parameters.AddWithValue("@i_Court_id", cls.Court_id);
                cmd.Parameters.AddWithValue("@i_PeReT", cls.PeReT);
                cmd.Parameters.AddWithValue("@i_TotalPaymentTime", cls.TotalPaymentTime);
                cmd.Parameters.AddWithValue("@i_Total_require", cls.Total_require);
                cmd.Parameters.AddWithValue("@i_Vat_rate", cls.Vat_rate);
                cmd.Parameters.AddWithValue("@i_Interest_rate", cls.Interest_rate);
                cmd.Parameters.AddWithValue("@i_Total_period", cls.Total_period);
                cmd.Parameters.AddWithValue("@i_Total_sum", cls.Total_sum);
                cmd.Parameters.AddWithValue("@i_Total_Interest", cls.Total_Interest);
                cmd.Parameters.AddWithValue("@i_Total_Tax", cls.Total_Tax);
                cmd.Parameters.AddWithValue("@i_Total_leasing", cls.Total_leasing);
                cmd.Parameters.AddWithValue("@i_Total_Net_leasing", cls.Total_Net_leasing);
                cmd.Parameters.AddWithValue("@i_Period_cal", cls.Period_cal);
                cmd.Parameters.AddWithValue("@i_Period_interst", cls.Period_interst);
                cmd.Parameters.AddWithValue("@i_Period_tax", cls.Period_tax);
                cmd.Parameters.AddWithValue("@i_Period_pure", cls.Period_pure);
                cmd.Parameters.AddWithValue("@i_Period_payment", cls.Period_payment);
                cmd.Parameters.AddWithValue("@i_Period_require", cls.Period_require);
                cmd.Parameters.AddWithValue("@i_Total_period_length", cls.Total_period_length);
                cmd.Parameters.AddWithValue("@i_Total_period_lose", cls.Total_period_lose);
                cmd.Parameters.AddWithValue("@i_Total_period_left", cls.Total_period_left);
                cmd.Parameters.AddWithValue("@i_Total_payment_left", cls.Total_payment_left);
                cmd.Parameters.AddWithValue("@i_Payment_schedule", cls.Payment_schedule);
                cmd.Parameters.AddWithValue("@i_First_payment_date", cls.First_payment_date);
                cmd.Parameters.AddWithValue("@i_Car_register_date", cls.Car_register_date);
                cmd.Parameters.AddWithValue("@i_Car_license_plate", cls.Car_license_plate);
                cmd.Parameters.AddWithValue("@i_Car_plate_province", cls.Car_plate_province);
                cmd.Parameters.AddWithValue("@i_Car_type", cls.Car_type);
                cmd.Parameters.AddWithValue("@i_Car_feature", cls.Car_feature);
                cmd.Parameters.AddWithValue("@i_Car_brand", cls.Car_brand);
                cmd.Parameters.AddWithValue("@i_Car_model", cls.Car_model);
                cmd.Parameters.AddWithValue("@i_Car_year", cls.Car_year);
                cmd.Parameters.AddWithValue("@i_Car_color", cls.Car_color);
                cmd.Parameters.AddWithValue("@i_Car_engine_no", cls.Car_engine_no);
                cmd.Parameters.AddWithValue("@i_Car_engine_no_at", cls.Car_engine_no_at);
                cmd.Parameters.AddWithValue("@i_Car_engine_brand", cls.Car_engine_brand);
                cmd.Parameters.AddWithValue("@i_Car_chassis_no", cls.Car_chassis_no);
                cmd.Parameters.AddWithValue("@i_Car_chassis_no_at", cls.Car_chassis_no_at);
                cmd.Parameters.AddWithValue("@i_Car_fual_type", cls.Car_fual_type);
                cmd.Parameters.AddWithValue("@i_Car_gas_No", cls.Car_gas_No);
                cmd.Parameters.AddWithValue("@i_Car_used_id", cls.Car_used_id);
                cmd.Parameters.AddWithValue("@i_Car_distance", cls.Car_distance);
                cmd.Parameters.AddWithValue("@i_Car_next_register_date", cls.Car_next_register_date);
                cmd.Parameters.AddWithValue("@i_Car_tax_value", cls.Car_tax_value);
                cmd.Parameters.AddWithValue("@i_Car_credits", cls.Car_credits);
                cmd.Parameters.AddWithValue("@i_Car_agent", cls.Car_agent);
                cmd.Parameters.AddWithValue("@i_Car_old_owner", cls.Car_old_owner);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_idcard", cls.Car_old_owner_idcard);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_b_date", cls.Car_old_owner_b_date);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_address_no", cls.Car_old_owner_address_no);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_vilage", cls.Car_old_owner_vilage);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_vilage_no", cls.Car_old_owner_vilage_no);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_alley", cls.Car_old_owner_alley);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_road", cls.Car_old_owner_road);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_subdistrict", cls.Car_old_owner_subdistrict);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_district", cls.Car_old_owner_district);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_province", cls.Car_old_owner_province);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_contry", cls.Car_old_owner_contry);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_zipcode", cls.Car_old_owner_zipcode);
                cmd.Parameters.AddWithValue("@i_Cust_id", cls.Cust_id);
                cmd.Parameters.AddWithValue("@i_Tent_car_id", cls.Tent_car_id);
                cmd.Parameters.AddWithValue("@i_Cheque_receiver", cls.Cheque_receiver);
                cmd.Parameters.AddWithValue("@i_Cheque_bank", cls.Cheque_bank);
                cmd.Parameters.AddWithValue("@i_Cheque_bank_branch", cls.Cheque_bank_branch);
                cmd.Parameters.AddWithValue("@i_Cheque_number", cls.Cheque_number);
                cmd.Parameters.AddWithValue("@i_Cheque_sum", cls.Cheque_sum);
                cmd.Parameters.AddWithValue("@i_Cheque_receive_date", cls.Cheque_receive_date);
                cmd.Parameters.AddWithValue("@i_Contract_status", cls.Contract_status);
                cmd.Parameters.AddWithValue("@i_Leasings_save_date", cls.Leasings_save_date);

                cmd.ExecuteNonQuery();

                return true;
            }
            catch (MySqlException ex)
            {
                error = "MysqlException ==> Managers_Leasings --> Car_Leasings_Manager --> addCarLeasings() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return false;
            }
            catch (Exception ex)
            {
                error = "Exception ==> Managers_Leasings --> Car_Leasings_Manager --> addCarLeasings() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return false;
            }
            finally
            {
                con.Close();
            }
        }

        public bool editCarLeasings(Car_Leasings cls)
        {
            MySqlConnection con = MySQLConnection.connectionMySQL();
            try
            {
                /* 
                 * :: StoredProcedure :: [ u_car_leasings ] :: 
                 * `u_car_leasings`(in  i_Leasing_id  varchar(50),              in  i_Deps_no  varchar(50),                     in  i_Leasing_no  varchar(50),                  in  i_Leasing_code_id  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     utf8                  utf8_general_ci       utf8_general_ci   
                 *         		    in  i_Leasing_date  date,                   in  i_Branch_id  int(11),                       in  i_Zone_id  int(11),                         in  i_Court_id  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                 *         		    in  i_PeReT  varchar(255),                  in  i_TotalPaymentTime  int(11),                in  i_Total_require  double(10,2),              in  i_Vat_rate  double(10,2),   in  i_Interest_rate  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                 *         		    in  i_Total_period  int(11),                in  i_Total_sum  double(10,2),                  in  i_Total_Interest  double(10,2),             in  i_Total_Tax  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                 *         		    in  i_Total_leasing  double(10,2),          in  i_Total_Net_leasing  double(10,2),          in  i_Period_cal  double(10,2),                 in  i_Period_interst  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                 *         		    in  i_Period_tax  double(10,2),             in  i_Period_pure  double(10,2),                in  i_Period_payment  double(10,2),             in  i_Period_require  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                 *         		    in  i_Total_period_length  varchar(50),     in  i_Total_period_lose  int(11),               in  i_Total_period_left  int(11),               in  i_Total_payment_left  double(10,2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                 *         		    in  i_Payment_schedule  int(11),            in  i_First_payment_date  date,                 in  i_Car_register_date  date,                  in  i_Car_license_plate  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                 *         		    in  i_Car_plate_province  int(11),          in  i_Car_type  varchar(255),                   in  i_Car_feature  varchar(255),                in  i_Car_brand  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                 *         		    in  i_Car_model  varchar(255),              in  i_Car_year  varchar(255),                   in  i_Car_color  varchar(255),                  in  i_Car_engine_no  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                 *         		    in  i_Car_engine_no_at  varchar(255),       in  i_Car_engine_brand  varchar(255),           in  i_Car_chassis_no  varchar(255),             in  i_Car_chassis_no_at  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                 *         		    in  i_Car_fual_type  varchar(255),          in  i_Car_gas_No  varchar(255),                 in  i_Car_used_id  int(11),                     in  i_Car_distance  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                 *        		    in  i_Car_next_register_date  date,         in  i_Car_tax_value  double(10,2),              in  i_Car_credits  varchar(255),                in  i_Car_agent  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                 *         		    in  i_Car_old_owner  varchar(255),          in  i_Car_old_owner_idcard  varchar(255),       in  i_Car_old_owner_b_date  date,               in  i_Car_old_owner_address_no  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                 *         		    in  i_Car_old_owner_vilage  varchar(255),   in  i_Car_old_owner_vilage_no  varchar(255),    in  i_Car_old_owner_alley  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                 *         		    in  i_Car_old_owner_road  varchar(255),     in  i_Car_old_owner_subdistrict  varchar(255),  in  i_Car_old_owner_district  varchar(255),     in  i_Car_old_owner_province  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                 *         		    in  i_Car_old_owner_contry  varchar(255),   in  i_Car_old_owner_zipcode  varchar(255),      in  i_Cust_id  varchar(50),                     in  i_Tent_car_id  int(11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                 *         		    in  i_Cheque_receiver  varchar(255),        in  i_Cheque_bank  varchar(255),                in  i_Cheque_bank_branch  varchar(255),         in  i_Cheque_number  varchar(255),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                 *         		    in  i_Cheque_sum  double(10,2),             in  i_Cheque_receive_date  date,                in  i_Contract_status  varchar(5),              in  i_Leasings_save_date  datetime)
                 * 
                 */

                con.Open();
                MySqlCommand cmd = new MySqlCommand("u_car_leasings", con);
                cmd.CommandType = CommandType.StoredProcedure;

                cmd.Parameters.AddWithValue("@i_Leasing_id", cls.Leasing_id);
                cmd.Parameters.AddWithValue("@i_Deps_no", cls.Deps_no);
                cmd.Parameters.AddWithValue("@i_Leasing_no", cls.Leasing_no);
                cmd.Parameters.AddWithValue("@i_Leasing_code_id", cls.Leasing_code_id);
                cmd.Parameters.AddWithValue("@i_Leasing_date", cls.Leasing_date);
                cmd.Parameters.AddWithValue("@i_Branch_id", cls.Branch_id);
                cmd.Parameters.AddWithValue("@i_Zone_id", cls.Zone_id);
                cmd.Parameters.AddWithValue("@i_Court_id", cls.Court_id);
                cmd.Parameters.AddWithValue("@i_PeReT", cls.PeReT);
                cmd.Parameters.AddWithValue("@i_TotalPaymentTime", cls.TotalPaymentTime);
                cmd.Parameters.AddWithValue("@i_Total_require", cls.Total_require);
                cmd.Parameters.AddWithValue("@i_Vat_rate", cls.Vat_rate);
                cmd.Parameters.AddWithValue("@i_Interest_rate", cls.Interest_rate);
                cmd.Parameters.AddWithValue("@i_Total_period", cls.Total_period);
                cmd.Parameters.AddWithValue("@i_Total_sum", cls.Total_sum);
                cmd.Parameters.AddWithValue("@i_Total_Interest", cls.Total_Interest);
                cmd.Parameters.AddWithValue("@i_Total_Tax", cls.Total_Tax);
                cmd.Parameters.AddWithValue("@i_Total_leasing", cls.Total_leasing);
                cmd.Parameters.AddWithValue("@i_Total_Net_leasing", cls.Total_Net_leasing);
                cmd.Parameters.AddWithValue("@i_Period_cal", cls.Period_cal);
                cmd.Parameters.AddWithValue("@i_Period_interst", cls.Period_interst);
                cmd.Parameters.AddWithValue("@i_Period_tax", cls.Period_tax);
                cmd.Parameters.AddWithValue("@i_Period_pure", cls.Period_pure);
                cmd.Parameters.AddWithValue("@i_Period_payment", cls.Period_payment);
                cmd.Parameters.AddWithValue("@i_Period_require", cls.Period_require);
                cmd.Parameters.AddWithValue("@i_Total_period_length", cls.Total_period_length);
                cmd.Parameters.AddWithValue("@i_Total_period_lose", cls.Total_period_lose);
                cmd.Parameters.AddWithValue("@i_Total_period_left", cls.Total_period_left);
                cmd.Parameters.AddWithValue("@i_Total_payment_left", cls.Total_payment_left);
                cmd.Parameters.AddWithValue("@i_Payment_schedule", cls.Payment_schedule);
                cmd.Parameters.AddWithValue("@i_First_payment_date", cls.First_payment_date);
                cmd.Parameters.AddWithValue("@i_Car_register_date", cls.Car_register_date);
                cmd.Parameters.AddWithValue("@i_Car_license_plate", cls.Car_license_plate);
                cmd.Parameters.AddWithValue("@i_Car_plate_province", cls.Car_plate_province);
                cmd.Parameters.AddWithValue("@i_Car_type", cls.Car_type);
                cmd.Parameters.AddWithValue("@i_Car_feature", cls.Car_feature);
                cmd.Parameters.AddWithValue("@i_Car_brand", cls.Car_brand);
                cmd.Parameters.AddWithValue("@i_Car_model", cls.Car_model);
                cmd.Parameters.AddWithValue("@i_Car_year", cls.Car_year);
                cmd.Parameters.AddWithValue("@i_Car_color", cls.Car_color);
                cmd.Parameters.AddWithValue("@i_Car_engine_no", cls.Car_engine_no);
                cmd.Parameters.AddWithValue("@i_Car_engine_no_at", cls.Car_engine_no_at);
                cmd.Parameters.AddWithValue("@i_Car_engine_brand", cls.Car_engine_brand);
                cmd.Parameters.AddWithValue("@i_Car_chassis_no", cls.Car_chassis_no);
                cmd.Parameters.AddWithValue("@i_Car_chassis_no_at", cls.Car_chassis_no_at);
                cmd.Parameters.AddWithValue("@i_Car_fual_type", cls.Car_fual_type);
                cmd.Parameters.AddWithValue("@i_Car_gas_No", cls.Car_gas_No);
                cmd.Parameters.AddWithValue("@i_Car_used_id", cls.Car_used_id);
                cmd.Parameters.AddWithValue("@i_Car_distance", cls.Car_distance);
                cmd.Parameters.AddWithValue("@i_Car_next_register_date", cls.Car_next_register_date);
                cmd.Parameters.AddWithValue("@i_Car_tax_value", cls.Car_tax_value);
                cmd.Parameters.AddWithValue("@i_Car_credits", cls.Car_credits);
                cmd.Parameters.AddWithValue("@i_Car_agent", cls.Car_agent);
                cmd.Parameters.AddWithValue("@i_Car_old_owner", cls.Car_old_owner);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_idcard", cls.Car_old_owner_idcard);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_b_date", cls.Car_old_owner_b_date);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_address_no", cls.Car_old_owner_address_no);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_vilage", cls.Car_old_owner_vilage);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_vilage_no", cls.Car_old_owner_vilage_no);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_alley", cls.Car_old_owner_alley);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_road", cls.Car_old_owner_road);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_subdistrict", cls.Car_old_owner_subdistrict);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_district", cls.Car_old_owner_district);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_province", cls.Car_old_owner_province);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_contry", cls.Car_old_owner_contry);
                cmd.Parameters.AddWithValue("@i_Car_old_owner_zipcode", cls.Car_old_owner_zipcode);
                cmd.Parameters.AddWithValue("@i_Cust_id", cls.Cust_id);
                cmd.Parameters.AddWithValue("@i_Tent_car_id", cls.Tent_car_id);
                cmd.Parameters.AddWithValue("@i_Cheque_receiver", cls.Cheque_receiver);
                cmd.Parameters.AddWithValue("@i_Cheque_bank", cls.Cheque_bank);
                cmd.Parameters.AddWithValue("@i_Cheque_bank_branch", cls.Cheque_bank_branch);
                cmd.Parameters.AddWithValue("@i_Cheque_number", cls.Cheque_number);
                cmd.Parameters.AddWithValue("@i_Cheque_sum", cls.Cheque_sum);
                cmd.Parameters.AddWithValue("@i_Cheque_receive_date", cls.Cheque_receive_date);
                cmd.Parameters.AddWithValue("@i_Contract_status", cls.Contract_status);
                cmd.Parameters.AddWithValue("@i_Leasings_save_date", cls.Leasings_save_date);

                cmd.ExecuteNonQuery();

                return true;
            }
            catch (MySqlException ex)
            {
                error = "MysqlException ==> Managers_Leasings --> Car_Leasings_Manager --> editCarLeasings() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return false;
            }
            catch (Exception ex)
            {
                error = "Exception ==> Managers_Leasings --> Car_Leasings_Manager --> editCarLeasings() : " + ex.Message.ToString();
                Log_Error._writeErrorFile(error);
                return false;
            }
            finally
            {
                con.Close();
            }
        }
    }
}